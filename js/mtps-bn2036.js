function jsTrim(s){return s.replace(/(^\s+)|(\s+$)/g,"")}function Track(trackParm,objLink){if(objLink.innerText&&jsTrim(objLink.innerText))LinkText=objLink.innerText;else if(objLink.all&&objLink.all(0).alt)LinkText=objLink.all(0).alt;var strDomain=document.domain,s=trackParm.split("|"),strLinkArea,strLinkId,strPageRegion;if(trackParm.substring(0,1)=="|"){strPageRegion=s[1];strLinkArea=s[2];strLinkId=s[2]+s[3]}else{strLinkArea=s[0];strLinkId=s[0]+s[1]}if(typeof LinkText=="undefined"||!LinkText||LinkText=="")LinkText=strLinkId;ctUrl=objLink.href+"?LinkId="+strLinkId+"&LinkArea="+strLinkArea;if(typeof DCSext!="undefined"){DCSext.wt_strHeadlnLocale=detectedLocale;DCSext.wt_strCat=strLinkArea+"|"+detectedLocale;DCSext.wt_strUrl=window.location.href.toLowerCase();DCSext.wt_strArea=strPageRegion}return false}

var loadedFired=false;Sys.Application.add_load(SetLoadedFired);function SetLoadedFired(el){loadedFired=true}function EyeBrowMenuBarSetHeightById(tFlyId){var v=document.getElementById(tFlyId);EyeBrowMenuBarSetHeight(v);TFly_Reposition(v)}function EyeBrowMenuBarSetHeight(TFly){var maxHeight=200,maxWidth=275,scrollbarWidth=20,scrollbarHeight=20,baseHeight=5,baseWidth=5;if(TFly.DT.scrollHeight>maxHeight){baseWidth+=scrollbarWidth;baseHeight+=maxHeight}else baseHeight+=TFly.DT.scrollHeight;if(TFly.DT.scrollWidth>maxWidth){baseHeight+=scrollbarHeight;baseWidth+=maxWidth}else baseWidth+=TFly.DT.scrollWidth;if(baseWidth>maxWidth||baseHeight>maxHeight)TFly.DT.style.overflow="auto";TFly.DT.style.width=baseWidth+"px";TFly.DT.style.height=baseHeight+"px"}function GetEyeNodeRetrievalUrl(el){return el.attributes.getNamedItem("name").value}function FindEyeSection(el){var sections=el.getElementsByTagName("SPAN");if(sections.count==0)return null;else return sections[0]}function ExpEye(TFly){if(loadedFired==true&&TFly.request==null)if(TFly.InLoadingState==false){TFly.InLoadingState=true;TFly.request==ajaxEye(TFly)}}function ajaxEye(TFly){var el=FindEyeSection(TFly.DT);if(el==null)return;TFly.DT.style.cursor="progress";var wRequest=new Sys.Net.WebRequest;wRequest.set_httpVerb("GET");wRequest.set_url(GetEyeNodeRetrievalUrl(el));wRequest.set_userContext(TFly);wRequest.add_completed(OnEyeCompleted);wRequest.invoke()}function OnEyeCompleted(executor,eventArgs){if(executor.get_responseAvailable()){var TFly=executor.get_webRequest().get_userContext();TFly.DT.style.overflow="auto";TFly.DT.innerHTML=executor.get_responseData();TFly.DT.style.cursor="default";window.setTimeout("EyeBrowMenuBarSetHeightById('"+TFly.id+"')",50);TFly.InLoadingState=false}}



function IsPageRated(objID,labelID,text,flyoutID,btn){obj=$get(objID);if(obj.Rated){flyout=$get(flyoutID);TFly_Popup(flyout,false);window.setTimeout(function(){btn.disabled=true},100);return true}else{label=$get(labelID);if(label.timer)window.clearTimeout(label.timer);else{label.className_=label.className;label.innerHTML_=label.innerHTML;label.className="WarningMessage";label.innerHTML=text}label.timer=window.setTimeout(function(){label.className=label.className_;label.innerHTML=label.innerHTML_;label.timer=null},3000)}return false}function tbNavParent(navUrl){window.top.location.href=navUrl}function RegisterAutoSubmit(objName,btnName,tag){window.onbeforeunload_autosubmit=window.onbeforeunload;window.onbeforeunload=function(){if(window.onbeforeunload_autosubmit)window.onbeforeunload_autosubmit();SubmitRating(objName,btnName,tag)}}function SubmitRating(objName,btnName,tag){var obj=$get(objName),btn=document.getElementById(btnName);if(obj&&obj.Rated&&btn){btn.disabled=false;btn.click();var d=new Date;d.setFullYear(d.getFullYear()+1);var CookieInfo=tag+"="+escape("xxx")+";expires="+d.toGMTString()+" path=/;";document.cookie=CookieInfo}}function CloseFLY(flyoutID){var TFly1=$get(flyoutID);TFly_Popup(TFly1,false);TFly1.IsHover=false}



var MtpsLoginStatus={};MtpsLoginStatus.SignInHappened=0;MtpsLoginStatus.LoginWindowHandle=0;MtpsLoginStatus.OverlayImagePath="/Platform/Controls/MtpsLoginStatus/resources/veil.gif";MtpsLoginStatus.DoPassportSignIn=function(url){if(MtpsLoginStatus.SignInHappened<1){var e=(screen.availWidth-850)*.5,f=(screen.availHeight-450)*.5,d="channelmode=0,directories=0,fullscreen=0,location=1,menubar=0,resizable=0,scrollbars=1,status=0,titlebar=0,toolbar=0,copyhistory=0,statusbar=0";MtpsLoginStatus.LoginWindowHandle=MtpsLoginStatus.OpenNewWindow(url,"_blank",d,900,500,e,f);MtpsLoginStatus.LoginWindowHandle.focus();MtpsLoginStatus.SignInHappened++;MtpsLoginStatus.ExpandOrCollapse("idPPMWOverlay");setTimeout("MtpsLoginStatus.CheckOnPassportSignIn()",100);return false}else return true};MtpsLoginStatus.CheckOnPassportSignIn=function(){if(MtpsLoginStatus.LoginWindowHandle.closed)MtpsLoginStatus.ExpandOrCollapse("idPPMWOverlay");else setTimeout("MtpsLoginStatus.CheckOnPassportSignIn()",100)};MtpsLoginStatus.OpenNewWindow=function(m,j,d,f,e,a,b){var g="toolbar, location, directories, status, menubar, scrollbars, resizable",i="width="+(f>0?f:GetWindowWidth())+", ",h="height="+(e>0?e:GetWindowHeight())+", ";a=a?a:0;var k="screenX="+a+", left="+a+", ";b=b?b:0;var l="screenY="+b+", top="+b,c=window.open(m,j,(d=="all"?g:d)+", "+i+h+k+l);if(c!=null)c.focus();return c};MtpsLoginStatus.ExpandOrCollapse=function(){for(var i=0;i<MtpsLoginStatus.ExpandOrCollapse.arguments.length;i++){var element=document.getElementById(MtpsLoginStatus.ExpandOrCollapse.arguments[i]);element.style.display=element.style.display=="none"?"block":"none";element.style.background=element.style.background==""?"url("+MtpsLoginStatus.OverlayImagePath+") repeat":""}}



function dolivesearch(sender){var o=document.getElementById(sender);if(o.className=="TextBoxSearch")document.getElementById("go").value="false";else{document.getElementById("go").value="true";if(typeof dcsMultiTrack=="function"){var dcsuri,dcssip,ti;dcsuri="results.aspx";dcssip="search.live.com";ti="_STO_SearchButton: Web";dcsMultiTrack("DCS.dcsuri",dcsuri,"DCS.dcssip",dcssip,"WT.ti",ti,"WT.dl","2","WT.z_srch_t","","DCS.dcsqry","","WT.ad","","WT.mc_id","");DCS.dcsuri=DCS.dcssip=DCS.dcsqry=WT.ti=WT.z_srch_t=""}}}



function tabs_onFocusSearch(sender){if(sender.isActive)return;sender.originalValue=sender.value;sender.value="";sender.className="TabStrip_SearchBoxActive";sender.isActive=true}function tabs_onBlurSearch(sender){if(sender.value.trim()==""){sender.value=sender.originalValue;sender.className="TabStrip_SearchBox";sender.isActive=false}}



function TFly_Init(name,offsetLeft,offsetTop,alignment,anyIter,anyTime,staticHover,popupHover,popupLatency,hideLatency,onInit,onPreAnimate,onPopup,onHide){var TFly=document.getElementById(name);TFly.alignment=alignment;TFly.DT=document.getElementById(name+"_Popup");TFly.F=document.getElementById(name+"_Anim");TFly.oX=offsetLeft;TFly.oY=offsetTop;TFly.AnyIter=anyIter;TFly.AnyTime=anyTime;TFly.popupLatency=popupLatency;TFly.hideLatency=hideLatency;TFly.onPopup=onPopup;TFly.onPreAnimate=onPreAnimate;TFly.onHide=onHide;TFly.IsHover=false;TFly.InLoadingState=false;TFly.className_=TFly.className;TFly.DT.className_=TFly.DT.className;TFly.onmouseover=function(){TFly.IsHover=true;if(staticHover!="")TFly.className=staticHover;TFly_Popup(TFly,true)};TFly.onmouseout=function(){if(staticHover!="")TFly.className=TFly.className_;TFly_Popup(TFly,false);TFly.DT.blur();TFly.IsHover=false};if(document.all){TFly.onactivate=function(){if(!TFly.IsHover)TFly.onmouseover()};TFly.ondeactivate=function(){TFly.onmouseout()}}else{TFly.onfocus=function(){TFly.onmouseover()};TFly.onblur=function(){TFly.onmouseout()}}TFly.DT.onmouseover=function(){TFly.IsHover=true;if(popupHover!="")TFly.DT.className=popupHover;TFly_Popup(TFly,true)};TFly.DT.onmouseout=function(){if(popupHover!="")TFly.DT.className=TFly.DT.className_;TFly_Popup(TFly,false);TFly.IsHover=false};TFly_CallClientFunction(onInit,TFly)}function TFly_Reposition(TFly){var clientWidth=document.body.scrollWidth-20,width=TFly.DT.offsetWidth,absX=TFly.DT.offsetLeft,d=TFly.DT;while(d=d.offsetParent)absX+=d.offsetLeft;if(clientWidth<absX+width){var diff=clientWidth-absX-width;TFly.DT.style.left=TFly.DT.offsetLeft+diff+"px"}}function TFly_CallClientFunction(name,TFly){if(name!=null&&name!="")eval(name+"(TFly);")}function TFly_SetPosition(TFly,obj){obj.style.top=TFly.oY+TFly.offsetHeight+"px";obj.style.left=TFly.oX+(TFly.offsetWidth-obj.offsetWidth)*(1+TFly.alignment)/2+"px"}function TFly_Popup(TFly,value){if(TFly.onPreAnimate)TFly_CallClientFunction(TFly.onPreAnimate,TFly);if(TFly.timer!=null)window.clearTimeout(TFly.timer);if(value){if(TFly.status=="on")return;var timeout=TFly.status=="active"?0:TFly.popupLatency;if(TFly.AnyIter>0&&TFly.AnyTime>0)TFly.timer=window.setTimeout(function(){TFly_AnimateStart(TFly,true,TFly.F.curIter)},timeout);else TFly.timer=window.setTimeout(function(){TFly_SetVisibility(TFly,true)},timeout)}else{if(TFly.status=="off")return;var timeout=TFly.status=="active"?0:TFly.hideLatency;if(TFly.AnyIter>0&&TFly.AnyTime>0)TFly.timer=window.setTimeout(function(){TFly_AnimateStart(TFly,false,TFly.F.curIter)},timeout);else TFly.timer=window.setTimeout(function(){TFly_SetVisibility(TFly,false)},timeout)}}function TFly_SetVisibility(TFly,value){if(value==true){TFly_SetPosition(TFly,TFly.DT);TFly.DT.style.visibility="visible";TFly.style.zIndex="999";TFly_Reposition(TFly)}else{TFly.DT.style.visibility="hidden";TFly.style.zIndex="0";TFly.DT.style.left="-10000px"}}function TFly_AnimateStart(TFly,inout,curIter){if(TFly.F.timer!=null)window.clearTimeout(TFly.F.timer);if(curIter==null)curIter=0;if(TFly.status!="active"){TFly.status="active";TFly.F.style.visibility="visible";TFly.DT.style.visibility="hidden"}if(curIter<0||curIter>TFly.AnyIter){TFly.F.curIter=curIter<1?0:TFly.AnyIter;TFly.status=TFly.F.curIter==TFly.AnyIter?"on":"off";TFly.F.style.visibility="hidden";TFly_SetPosition(TFly,TFly.DT);TFly.style.zIndex=TFly.F.curIter==TFly.AnyIter?"999":"0";if(TFly.F.curIter==TFly.AnyIter){TFly.status="on";TFly_SetVisibility(TFly,true);TFly_CallClientFunction(TFly.onPopup,TFly)}else{TFly.status="off";TFly_SetVisibility(TFly,false);TFly_CallClientFunction(TFly.onHide,TFly)}}else{var per=curIter*(95/TFly.AnyIter)+5;TFly.F.style.visibility="hidden";TFly.F.style.width=TFly.DT.offsetWidth/100*per+"px";TFly.F.style.height=TFly.DT.offsetHeight/100*per+"px";TFly_SetPosition(TFly,TFly.F);TFly.F.style.visibility="visible";var timeout=per==100?0:TFly.AnyTime-TFly.AnyTime/TFly.AnyIter*curIter;curIter+=inout?1:-1;TFly.F.timer=window.setTimeout(function(){TFly_AnimateStart(TFly,inout,curIter)},timeout);TFly.F.curIter=curIter}}

