
(function(){var ymem_common=YAHOO.namespace("Membership.common");ymem_common.autoClearTextInput=function(e,oParams){if(this.type=="text"&&this.value==oParams.defaultVal){this.value="";}};ymem_common.dataCache={};ymem_common.toTitleCase=function(str){var i,j,stringParts=[],lastCharCase="",thisCharCase="",allOneCase=true,charCode=0,tmpStr="";var isLowerCase=function(charCode){return(charCode>=97&&charCode<=122);};var isUpperCase=function(charCode){return(charCode>=65&&charCode<=90);};var getCharCase=function(charCode){return isLowerCase(charCode)?"lower":(isUpperCase(charCode)?"upper":false);};if(typeof str==="string"){stringParts=str.split(" ");for(i=0;i<stringParts.length;i++){tmpStr=stringParts[i];for(j=0;j<tmpStr.length;j++){charCode=tmpStr.charCodeAt(j);thisCharCase=getCharCase(charCode);if(j==0){lastCharCase=thisCharCase;}else if(thisCharCase!==lastCharCase){allOneCase=false;break;}}
if(allOneCase){tmpStr=tmpStr.toLowerCase();stringParts[i]=tmpStr.charAt(0).toUpperCase()+tmpStr.substr(1,tmpStr.length);}}}
return stringParts.join(" ");};ymem_common.removeAccentedChars=function(str){var oAccents=ymem_common.oAccents;for(prop in oAccents){str=str.replace(oAccents[prop],prop);}
return str;};ymem_common.oAccents={A:/[ÁÀÂÄ???Å????????]/g,a:/[áàâä???å????????]/g,AE:/[Æ?]/g,ae:/[æ?]/g,OE:/[Œ]/g,oe:/[œ]/g,B:/[?]/g,b:/[?]/g,C:/[??Ç]/g,c:/[??ç]/g,D:/[??]/g,d:/[??]/g,E:/[ÉÈ?ÊË?????]/g,e:/[éè?êë?????]/g,F:/[?]/g,f:/[?]/g,G:/[???]/g,g:/[???]/g,I:/[ÍÌÎÏ????]/g,i:/[íìîï????]/g,K:/[??]/g,k:/[??]/g,L:/[???]/g,l:/[???]/g,M:/[??]/g,m:/[??]/g,N:/[??Ñ]/g,n:/[??ñ]/g,O:/[ÓÒÔÖ?????????Ø]/g,o:/[óòôö?????????ø]/g,P:/[??]/g,p:/[??]/g,R:/[??]/g,r:/[??]/g,S:/[????ß]/g,s:/[????ß]/g,T:/[??]/g,t:/[??]/g,U:/[ÚÙÛÜ?????????]/g,u:/[úùûü?????????]/g,W:/[??]/g,w:/[??]/g,Y:/[Ý???]/g,y:/[ý???]/g,Z:/[???]/g,z:/[???]/g};})();var ymem_common=YAHOO.Membership.common;
(function(){var ymem_ns=YAHOO.namespace("Membership.ns");})();var ymem_ns=YAHOO.Membership.ns;
if(ymem_common==undefined){var ymem_common=YAHOO.namespace("Membership.common");}
ymem_common.RoundedButton=function(sBtnId,sBtnContent,sClassNames,canRollover,iTabIndex,click_Callback){var Event=YAHOO.util.Event||false;var Dom=YAHOO.util.Dom||false;var oThisButton=false;var isDefined=function(obj){return typeof obj!=="undefined";};var createButton=function(sBtnId,sContent,sBtnClasses,iTabIndex){try{var oExistingBtn=Dom.get(sBtnId);var oSiblingNode=oExistingBtn.nextSibling;oExistingBtn=oExistingBtn.parentNode.removeChild(oExistingBtn);var oBtn=document.createElement("div");var oTopSpan=document.createElement("span"),oBotSpan=null;oBtn.setAttribute("id",sBtnId+"-rnd");oBtn.setAttribute("title",sContent);Dom.addClass(oBtn,"rndBtn btn-standard "+sBtnClasses);oTopSpan.appendChild(oTopSpan.cloneNode(false));Dom.addClass(oTopSpan.firstChild,"cl")
Dom.addClass(oTopSpan,"ct");oBotSpan=oTopSpan.cloneNode(true);Dom.replaceClass(oBotSpan,"ct","cb");oBtn.appendChild(oTopSpan);oBtn.appendChild(oExistingBtn);oBtn.appendChild(oBotSpan);return{btn:oBtn,sibling:oSiblingNode};}catch(e){return false;}};var mouseoverout_SwitchBtnClass=function(e,oTrgt){var oHtmlEl=Dom.get(oTrgt);var sEventType=isDefined(e)?e.type:false;switch(sEventType){case"mouseover":Dom.addClass(oHtmlEl,"btn-hover")
break;case"mouseout":Dom.removeClass(oHtmlEl,"btn-hover")
break;}};var makeButton=function(sBtnId,sBtnContent,sClassNames,canRollover,iTabIndex,click_Callback){if(Dom&&Event&&sBtnId){var oRetObj=createButton(sBtnId,sBtnContent,sClassNames,iTabIndex);if(oRetObj){var oButton=oRetObj.btn;var oSibling=oRetObj.sibling;var oEvtTarget=oButton.getElementsByTagName("input")[0];if(canRollover){Event.on(oEvtTarget,"mouseover",mouseoverout_SwitchBtnClass,oButton,false);Event.on(oEvtTarget,"mouseout",mouseoverout_SwitchBtnClass,oButton,false);}
if(typeof click_Callback=="function"){Event.on(oEvtTarget,"click",function(e){click_Callback(e);},oButton,false);}
oThisButton=oButton;oSibling.parentNode.insertBefore(oButton,oSibling);}}};this.getButton=function(){return oThisButton;};var sBtnId=isDefined(sBtnId)?sBtnId:false;var sBtnContent=isDefined(sBtnContent)?sBtnContent:sBtnId;var sClassNames=isDefined(sClassNames)&&sClassNames!==null?sClassNames:"";var canRollover=isDefined(canRollover)?canRollover:false;var iTabIndex=isDefined(iTabIndex)?iTabIndex:"";var click_Callback=isDefined(click_Callback)?click_Callback:false;makeButton(sBtnId,sBtnContent,sClassNames,canRollover,iTabIndex,click_Callback);};
ymem_common.yidHelper=function(oConfig){var self=this;var Dom=YAHOO.util.Dom;var Event=YAHOO.util.Event;var Anim=YAHOO.util.Animation;var Conn=YAHOO.util.Connect;var config=oConfig;config.elements.fieldFnameEl=Dom.get(config.fnameFieldId);config.elements.fieldLnameEl=Dom.get(config.lnameFieldId);if(config.elements.fieldFnameEl==null||config.elements.fieldLnameEl==null){return{init:function(){return false;}};}
var results={lastresultset:null,lastnames:{fname:"",lname:"",yid:""}};var moduleStates={busy:"busy",idle:"idle"};var currentState=moduleStates.idle;var FLAGS={enableYidFldBlurEvt:true,isRendered:false,isInCharInputState:false};var yidModule;var yidBlurTimeout;this.init=function(){config.elements.fieldFnameEl=Dom.get(config.fnameFieldId);config.elements.fieldLnameEl=Dom.get(config.lnameFieldId);config.elements.fieldYidEl=Dom.get(config.yidFieldId);config.elements.componentYidEl=Dom.get(config.yidComponentId);config.elements.componentNameEl=Dom.get(config.nameComponentId);config.elements.btnEl=this.ui.createBtnEl();config.elements.componentYidEl.appendChild(config.elements.btnEl);config.elements.guruIconEl=this.ui.createGuruIconEl(config.imgUrls.guruHappy);var yidLabels=Dom.getElementsByClassName("ymemformlabel","div",config.elements.componentYidEl);if(typeof yidLabels[0]!=="undefined"&&yidLabels[0]!==null){yidLabels[0].appendChild(config.elements.guruIconEl);}
yidModule=new YAHOO.widget.Module("yidHelper",{monitorresize:false,visible:true});with(Event){on([config.elements.fieldFnameEl,config.elements.fieldLnameEl],"change",function(e){setTimeout("yidHelper.nameFieldChange();",100);},this,true);on(config.elements.fieldYidEl,"blur",function(e){yidBlurTimeout=setTimeout("yidHelper.yidFieldBlur(null);",100);},this,true);on(config.elements.fieldYidEl,"keydown",this.yidKeyChange,this,true);}};this.getConfig=function(){return config;};this.isBusy=function(){return currentState==moduleStates.busy;};this.isIdle=function(){return currentState==moduleStates.idle;};this.setBusy=function(){currentState=moduleStates.busy;};this.setIdle=function(){currentState=moduleStates.idle;};this.hasSameNames=function(fname,lname){return results.lastnames.fname==fname&&results.lastnames.lname==lname;};this.hasSameYidVal=function(yidVal){return results.lastnames.yid==yidVal;};this.hasSuggestionResults=function(){return results.lastresultset!==null;};this.hasDefaultNameVals=function(fname,lname){var defaultVals={fname:config.firstnameDefaultVal,lname:config.lastnameDefaultVal}
return(defaultVals.fname!==""&&defaultVals.lname!==""&&(defaultVals.fname==fname||defaultVals.lname==lname));};this.hasComponentErr=function(compId){return this.hasFormValidator()&&yregFormValidator.componentHasErrMsg(compId);};this.hasFormValidator=function(){return typeof yregFormValidator=="object";};this.checkNameFields=function(){with(config.elements){var fname=fieldFnameEl.value,lname=fieldLnameEl.value;}
return fname!==""&&lname!==""&&!this.hasDefaultNameVals(fname,lname);};this.nameFieldChange=function(){var fname=config.elements.fieldFnameEl.value;var lname=config.elements.fieldLnameEl.value;if(this.checkNameFields()&&!this.hasComponentErr(config.elements.componentNameEl.id)){this.doSuggestions(false);results.lastnames.fname=fname;results.lastnames.lname=lname;}};this.yidFieldBlur=function(e){var yidFieldVal=config.elements.fieldYidEl.value;var isEmpty,isSameYid,hasNameErr;if(FLAGS.enableYidFldBlurEvt&&!this.hasComponentErr(config.elements.componentYidEl.id)){isSameYid=this.hasSameYidVal(yidFieldVal);isEmpty=yidFieldVal=="";hasNameErr=this.checkNameFields();if((!isSameYid&&!isEmpty)||(!isEmpty&&!hasNameErr)){this.doSuggestions(!isEmpty);}}
FLAGS.isInCharInputState=false;};this.yidBtnClick=function(){FLAGS.enableYidFldBlurEvt=true;this.yidFieldBlur();};this.yidKeyChange=function(e){var controlKeys=[16,20,9,13,33,34,37,39,46,17];var yidFieldVal=config.elements.fieldYidEl.value;var inArray=function(ary,value){for(var i=0;i<ary.length;i++){if(ary[i]==value)return true;}
return false;};if(e.keyCode&&!inArray(controlKeys,e.keyCode)){if(!FLAGS.isInCharInputState){this.ui.setCharInputState();this.ui.switchElementDisplay(config.elements.btnEl,true);this.ui.switchGuruIcon(config.imgUrls.guruHappy);FLAGS.isInCharInputState=true;FLAGS.enableYidFldBlurEvt=true;}
if(yidFieldVal.length>=3){this.ui.setBtnDisabled(false);}else{this.ui.setBtnDisabled(true)}}};this.doSuggestions=function(checkYidVal){if(this.hasFormValidator()){yregFormValidator.removeErrorFromDisplay(config.elements.componentYidEl.id);}
if(!this.hasComponentErr(config.elements.componentNameEl.id)){this.ui.setBusyState();this.ui.curPage=0;this.callValidatorApi(checkYidVal);}else{this.ui.setCorrectNameState();this.ui.switchElementDisplay(config.elements.btnEl,false);}};this.processSuggestions=function(xhrResponseObj){if(xhrResponseObj.SuggestedIDList){results.lastresultset=this.getHtmlListItemArray(xhrResponseObj.SuggestedIDList);this.ui.setPaginateState();}else{this.ui.setNotAvailState();this.ui.switchElementDisplay(config.elements.btnEl,true);}};this.callValidatorApi=function(checkYidVal){var cObj;var rand=Math.ceil(Math.random()*10000000);var xhrCallback={success:function(o){try{var respObj=eval("("+o.responseText+")");if(respObj.ResultCode&&respObj.ResultCode==config.jsonSuccessStr){self.ui.setYidChosenState();self.ui.switchElementDisplay(config.elements.btnEl,true);}else{self.processSuggestions(respObj);if(checkYidVal){self.ui.setFormValidatorErrState(config.elements.fieldYidEl.id,config.elements.componentYidEl.id,"idnotavail");}}}catch(err){self.ui.setNotAvailState();self.ui.switchElementDisplay(config.elements.btnEl,true);}},failure:function(o){self.ui.setNotAvailState();self.ui.switchElementDisplay(config.elements.btnEl,true);},timeout:15000};with(config.elements){var yidVal=fieldYidEl.value;var fnameVal=ymem_common.removeAccentedChars(fieldFnameEl.value);var lnameVal=ymem_common.removeAccentedChars(fieldLnameEl.value);if(yidVal==""){yidVal=".";}else if(!this.checkNameFields()){fnameVal="";lnameVal="";}}
cObj=Conn.asyncRequest("GET","/membership/json?PartnerName=yahoo_default&RequestVersion=1&AccountID="+yidVal+"&GivenName="+fnameVal+"&FamilyName="+lnameVal+"&ApiName=ValidateFields&"+rand,xhrCallback,null);};this.getHtmlListItemArray=function(suggIdList){var suggIdsAry=suggIdList;var divClass;var div,a,yidNumTxt,yidDisplayTxt,strYid;var truncateYid=function(strYid){var part1,part2,middle="...";if(strYid.length>18){part1=strYid.substr(0,13);part2=strYid.substr(-4,4);return part1+middle+part2;}
return strYid;};for(var i=0;i<suggIdsAry.length;i++){strYid=suggIdsAry[i];if(i<9){divClass="yidHelperSuggId padLeft";}else{divClass="yidHelperSuggId";}
div=this.ui.buildHtmlElement("div",false,false,divClass);a=this.ui.buildHtmlElement("a",false,false,false,"click",this.ui.setYidValue,{strYidVal:strYid});yidNumTxt=document.createTextNode((parseInt(i)+1)+".");yidDisplayTxt=document.createTextNode(truncateYid(strYid));a.appendChild(yidDisplayTxt);a.title=suggIdsAry[i];div.appendChild(yidNumTxt);div.appendChild(a);suggIdsAry[i]=div;}
return suggIdsAry;};this.ui={};this.ui.curPage=0;this.ui.navOpts={next:true,prev:false};this.ui.createBtnEl=function(){var btnEl=this.buildHtmlElement("input","yidHelperBtn",false,"hidden","click",self.yidBtnClick,self);btnEl.type="button";btnEl.value=config.strings.checkid;return btnEl;};this.ui.createGuruIconEl=function(imgSrc){var iconEl=this.buildHtmlElement("img","yidHelperGuruIcon",false,"hidden",null,null,null);iconEl.src=imgSrc;return iconEl;};this.ui.buildHtmlElement=function(elTag,elId,htmlStr,className,evt,callback,scope){var htmlEl=false;if(elTag)htmlEl=document.createElement(elTag);if(elTag=="a")htmlEl.href="#";if(elId)htmlEl.id=elId;if(htmlStr)htmlEl.innerHTML=htmlStr;if(className)Dom.addClass(htmlEl,className);if(evt&&callback&&scope){Event.on(htmlEl,evt,callback,scope,true);}
return htmlEl;};this.ui.refresh=function(){yidModule.render(config.elements.componentYidEl);FLAGS.isRendered=true;this.handleIEHasLayoutBug();};this.ui.setNotAvailState=function(){self.setIdle();this.setBtnDisabled(false);this.clearModule();this.switchElementDisplay(yidModule.header,true);this.switchElementDisplay(yidModule.body,true);this.switchElementDisplay(yidModule.footer,false);with(config.elements){this.setFormValidatorErrState(fieldYidEl.id,componentYidEl.id,"noidsavailable")}
yidModule.setHeader(config.strings.notavail);yidModule.setBody(config.strings.tofind);this.switchGuruIcon(config.imgUrls.guruSad);this.refresh();};this.ui.setYidValue=function(e,oParams){if(e){Event.preventDefault(e);}
results.lastnames.yid=(!self.hasComponentErr(config.elements.componentYidEl)&&!FLAGS.isInCharInputState)?config.elements.fieldYidEl.value:"";config.elements.fieldYidEl.value=oParams.strYidVal;if(self.hasFormValidator()){yregFormValidator.removeErrorFromDisplay(config.elements.componentYidEl.id);}
self.ui.setYidChosenState();};this.ui.setYidChosenState=function(){self.setIdle();this.setBtnDisabled(false);FLAGS.isInCharInputState=false;this.removeSuggestions();this.clearModule();this.switchElementDisplay(yidModule.header,true);this.switchElementDisplay(yidModule.body,true);this.switchElementDisplay(yidModule.footer,false);yidModule.setHeader(config.strings.set);yidModule.setBody(config.elements.fieldYidEl.value);this.addReversionLinks();this.switchGuruIcon(config.imgUrls.guruHappy);this.refresh();};this.ui.setCharInputState=function(){self.setIdle();this.setBtnDisabled(false);this.clearModule();this.switchElementDisplay(yidModule.header,false);this.switchElementDisplay(yidModule.body,true);this.switchElementDisplay(yidModule.footer,false);yidModule.setBody(config.strings.helpertext);this.addReversionLinks();this.refresh();};this.ui.addReversionLinks=function(){var yidLinkContainer,yidLinkA,suggsLinkA;var doYidLink=(results.lastnames.yid!==""&&results.lastnames.yid!==config.elements.fieldYidEl.value);var doSuggsLink=self.hasSuggestionResults();var yidCallback=function(e){Event.preventDefault(e);this.ui.setYidValue(null,{strYidVal:results.lastnames.yid});FLAGS.enableYidFldBlurEvt=true;};var suggsCallback=function(e){Event.preventDefault(e);this.ui.setPaginateState();clearTimeout(yidBlurTimeout);FLAGS.enableYidFldBlurEvt=true;};if(doYidLink){FLAGS.enableYidFldBlurEvt=false;yidLinkContainer=this.buildHtmlElement("span","yidHelperRevertYid",config.strings.setback,false,false);yidLinkA=this.buildHtmlElement("a",false," "+results.lastnames.yid,"activeNavLink","click",yidCallback,self);yidLinkContainer.appendChild(yidLinkA);yidModule.appendToFooter(yidLinkContainer);}
if(doSuggsLink){FLAGS.enableYidFldBlurEvt=false;suggsLinkA=this.buildHtmlElement("a","yidHelperShowSuggs",config.strings.showsuggsagain,"activeNavLink","click",suggsCallback,self);yidModule.appendToFooter(suggsLinkA);}
if(doYidLink||doSuggsLink){this.switchElementDisplay(yidModule.footer,true);}else{this.switchElementDisplay(yidModule.footer,false);}};this.ui.setYidAvailableState=function(){self.setIdle();this.setBtnDisabled(false);this.clearModule();this.switchElementDisplay(yidModule.header,false);this.switchElementDisplay(yidModule.body,true);this.switchElementDisplay(yidModule.footer,false);yidModule.setBody(config.elements.fieldYidEl.value+" is available.");this.refresh();};this.ui.setCorrectNameState=function(){self.setIdle();this.setBtnDisabled(false);this.clearModule();this.switchElementDisplay(yidModule.header,false);this.switchElementDisplay(yidModule.body,true);this.switchElementDisplay(yidModule.footer,false);yidModule.setBody(config.strings.nameerr);with(config.elements){this.setFormValidatorErrState(fieldYidEl.id,componentYidEl.id,"correctnameerrs")}
this.switchGuruIcon(config.imgUrls.guruSad);this.refresh();};this.ui.setFillInNameState=function(){self.setIdle();this.setBtnDisabled(false);this.clearModule();this.switchElementDisplay(yidModule.header,false);this.switchElementDisplay(yidModule.body,true);this.switchElementDisplay(yidModule.footer,false);yidModule.setBody(config.strings.fillin);this.refresh();};this.ui.setPaginateState=function(){var numOfResults=results.lastresultset.length;var numPerPage=config.resultsPerPage;var numOfPages=Math.ceil(numOfResults/numPerPage);var pageNum=this.curPage;var resultsPageAry,col1ResultsAry,col2ResultsAry;var col1=document.createElement("div"),col2=document.createElement("div");this.navOpts.next=(numOfPages>1&&this.curPage<(numOfPages-1));this.navOpts.prev=(this.curPage>0);self.setIdle();this.setBtnDisabled(false);this.clearModule();this.switchElementDisplay(yidModule.header,true);this.switchElementDisplay(yidModule.body,true);this.switchElementDisplay(yidModule.footer,false);yidModule.setHeader(this.getModuleElement("navEl"));yidModule.appendToHeader(document.createTextNode(config.strings.avail));resultsPageAry=results.lastresultset.slice((pageNum*numPerPage),((pageNum*numPerPage)+numPerPage));col1ResultsAry=resultsPageAry.slice(0,Math.ceil(numPerPage/2));col2ResultsAry=resultsPageAry.slice(col1ResultsAry.length,resultsPageAry.length);if(col1ResultsAry.length==1){col1.appendChild(col1ResultsAry[0]);col1.appendChild(this.buildHtmlElement("div",false,"&nbsp;","yidHelperSuggId padLeft"));}else{for(var i=0;i<col1ResultsAry.length;i++){col1.appendChild(col1ResultsAry[i]);}
for(i=0;i<col2ResultsAry.length;i++){col2.appendChild(col2ResultsAry[i]);}}
Dom.addClass([col1,col2],"col");Dom.addClass(col2,"right");yidModule.appendToBody(col1);yidModule.appendToBody(col2);this.refresh();};this.ui.setBusyState=function(){self.setBusy();this.setBtnDisabled(true);this.clearModule();this.switchElementDisplay(yidModule.header,false);this.switchElementDisplay(yidModule.body,true);this.switchElementDisplay(yidModule.footer,false);yidModule.setBody(this.getModuleElement("busyIconEl"));this.switchGuruIcon(config.imgUrls.guruHappy);this.refresh();};this.ui.pageNext=function(e){Event.preventDefault(e);if(this.ui.navOpts.next){this.ui.curPage++;this.ui.removeSuggestions();this.ui.setPaginateState();}};this.ui.pagePrev=function(e){Event.preventDefault(e);if(this.ui.navOpts.prev){this.ui.curPage--;this.ui.removeSuggestions();this.ui.setPaginateState();}};this.ui.getModuleElement=function(whichEl){var retEl=false;switch(whichEl){case"busyIconEl":var div=this.buildHtmlElement("div","yidHelperBusyIcon");var img=this.buildHtmlElement("img");var txtNode=document.createTextNode(config.strings.generating);img.src=config.imgUrls.busyIcon;img.alt=config.strings.loadingimgalt;div.appendChild(img);div.appendChild(txtNode);retEl=div;break;case"navEl":var nav=this.buildHtmlElement("div","yidHelperNav");var nextClass="yidHelperNav"+((this.navOpts.next)?" activeNavLink":"");var prevClass="yidHelperNav"+((this.navOpts.prev)?" activeNavLink":"");var next=this.buildHtmlElement("a",false,config.strings.next,nextClass,"click",this.pageNext,self);var sep=this.buildHtmlElement("span",false,config.strings.navseparator,"yidHelperNavSep");var prev=this.buildHtmlElement("a",false,config.strings.previous,prevClass,"click",this.pagePrev,self);with(nav){appendChild(prev);appendChild(sep);appendChild(next);}
retEl=nav;break;}
return retEl;};this.ui.clearModule=function(){var clearSuggestions=function(parentNode){if(parentNode==null)return;var suggNode,suggNodes=Dom.getElementsByClassName("yidHelperSuggId","div",parentNode);for(var i=0;i<suggNodes.length;i++){suggNode=suggNodes[i];suggNode.parentNode.removeChild(suggNode);}};clearSuggestions(yidModule.body);with(yidModule){setHeader("");setBody("");setFooter("");}};this.ui.setFormValidatorErrState=function(fieldId,componentId,errKey){if(fieldId&&componentId&&errKey){if(self.hasFormValidator()&&!self.hasComponentErr(componentId)){yregFormValidator.resetErrorQueue();yregFormValidator.addError(fieldId,componentId,errKey.toLowerCase());yregFormValidator.processErrorQueue();return true;}}
return false;};this.ui.switchElementDisplay=function(elRef,visible){if(elRef){if(visible){Dom.setStyle(elRef,"display","block");}else{Dom.setStyle(elRef,"display","none");}}};this.ui.removeSuggestions=function(){var elAry=Dom.getElementsByClassName("yidHelperSuggId",yidHelper.body);for(var i=0;i<elAry.length;i++){this.removeElement(elAry[i]);}};this.ui.switchGuruIcon=function(imgSrc){if(config.elements.guruIconEl!==null){config.elements.guruIconEl.src=imgSrc;}else{config.elements.guruIconEl=this.createGuruIconEl(imgSrc);config.elements.componentYidEl.appendChild(config.elements.guruIconEl);}
this.switchElementDisplay(config.elements.guruIconEl,true);};this.ui.removeElement=function(elRef){if(elRef&&elRef.parentNode){elRef.parentNode.removeChild(elRef);}};this.ui.setBtnDisabled=function(disabled){config.elements.btnEl.disabled=disabled;};this.ui.handleIEHasLayoutBug=function(){document.body.style.zoom=1.1;document.body.style.zoom='';};};
var yu=YAHOO.util;YAHOO.widget.PasswdMeter={result:'weak',tests:{len:true,letters:true,numbers:true,name:true,specials:true,repeat:true,order:true,verify:false},err_strings:{1:'Don\'t use your name in your password!',2:'Please don\'t repeat a character!',3:'Please don\'t use sequential characters! (i.e. abcd, 1234)',10:'Passwords do not match, please try again.'},js_strings:{'less':'Less secure','more':'More secure','how':'How secure is it?'},config:{passwd:yu.Dom.get('passwd'),passwd_verify:yu.Dom.get('passwd_verify'),hlp:yu.Dom.get('meter_help'),hlp_class:false,hlp_size:300,fnameData:yu.Dom.get('fname'),lnameData:yu.Dom.get('lname'),uidData:yu.Dom.get('uid'),how_secure:yu.Dom.get('how_secure'),meter_tag:yu.Dom.get('meter_tag'),min_len:6,max_len:32,bgcolor_strongest:'green',bgcolor_strong:'blue',bgcolor_mediocre:'orange',bgcolor_weak:'red'},init:function(){if(!this.config.passwd||!this.config.hlp||!this.config.how_secure||!this.config.meter_tag){alert('A required item was not found on the page!');return false;}
if(this.tests.verify&&!this.config.passwd_verify){alert('Cannot find verify password input');return false;}else if(this.tests.verify){yu.Event.addListener(this.config.passwd_verify,'blur',YAHOO.widget.PasswdMeter.verifyPass,YAHOO.widget.PasswdMeter,true);}
yu.Event.addListener(this.config.passwd,'keyup',YAHOO.widget.PasswdMeter.checkPass,YAHOO.widget.PasswdMeter,true);this.err_lg=new Array;this.err_lg[1]=false;this.err_lg[2]=false;this.err_lg[3]=false;this.err_lg[4]=false;this.config.how_secure.innerHTML=this.js_strings['how'];meter_div=document.createElement('div');meter_div.id='meter';this.config.meter_tag.appendChild(meter_div);for(i=1;i<5;i++){newdiv=document.createElement('div');newdiv.id='meter'+i;newdiv.style.backgroundColor='white';meter_div.appendChild(newdiv);}
txt=document.createTextNode(this.js_strings['less']);this.config.meter_tag.appendChild(txt);span=document.createElement('span');span.innerHTML=this.js_strings['more'];this.config.meter_tag.appendChild(span);},verifyPass:function(e){if(this.config.passwd_verify.value.length>0){if(this.config.passwd.value!=this.config.passwd_verify.value){this.doerror(10);return false;}}
this.showTip(true);return false;},checkPass:function(e){this.len=false;this.letters=false;this.numbers=false;this.name=false;this.specials=false;this.repeat=false;this.order=false;this.err_lg[1]=false;this.err_lg[2]=false;this.err_lg[3]=false;this.err_lg[4]=false;strPasswd=this.config.passwd.value;if(strPasswd.length>0){if(this.tests.len){this.len=this.test_len(strPasswd);}
if(this.tests.name){this.name=this.test_name(strPasswd);}
if(this.tests.letters){this.letters=this.test_letters(strPasswd);}
if(this.tests.numbers){this.numbers=this.test_numbers(strPasswd);}
if(this.tests.specials){this.specials=this.test_special(strPasswd);}
if(this.tests.repeat){this.repeat=this.test_repeatchar(strPasswd);}
if(this.tests.order){this.order=this.test_order(strPasswd);}
this.draw();}else{this.doerror(0);if(strPasswd.length==''){this.draw(true);}else{this.draw();}
if(yu.Dom.getStyle(this.config.hlp,'display')=='block'){this.showTip(true);}}},doerror:function(i,em){if(!em){if(i>0){str_tip=this.err_strings[i];with(yu.Dom){setStyle(this.config.hlp,'display','block');}
this.config.hlp.innerHTML='<p>'+str_tip+'</p>';this.showTip();}}
for(i=1;i<this.err_lg.length;i++){if(this.err_lg[i]){yu.Dom.setStyle('note'+i,'color','#ccc');}else{yu.Dom.setStyle('note'+i,'color','#000');}}},showTip:function(hide){if(hide){}else{xy=yu.Dom.getXY(this.config.passwd);yu.Dom.setStyle(this.config.hlp,'position','static');yu.Dom.setStyle(this.config.hlp,'z-index','999');yu.Dom.setStyle(this.config.hlp,'width',(this.config.hlp_size+'px'));xy[1]=xy[1]+20;yu.Dom.setXY(this.config.hlp,xy);if(this.config.hlp_class){if(this.config.passwd&&this.config.passwd.value){YAHOO.util.Dom.addClass(this.config.passwd,this.config.hlp_class);}
if(this.config.passwd_verify&&this.config.passwd_verify.value){YAHOO.util.Dom.addClass(this.config.passwd_verify,this.config.hlp_class);}}
yu.Dom.setStyle(this.config.hlp,'display','block');}
if(hide){yu.Dom.setStyle(this.config.hlp,'display','none');if(this.config.hlp_class){if(this.config.passwd){YAHOO.util.Dom.removeClass(this.config.passwd,this.config.hlp_class);}
if(this.config.passwd_verify){YAHOO.util.Dom.removeClass(this.config.passwd_verify,this.config.hlp_class);}}}},do_results:function(){this.err_lg[1]=false;this.err_lg[2]=false;this.err_lg[3]=false;this.err_lg[4]=false;if(this.numbers){this.err_lg[1]=true;}
if(this.specials){this.err_lg[2]=true;}
if(this.letters){this.err_lg[3]=true;}
if(this.len){this.err_lg[4]=true;}
result='weak';if(this.name){this.doerror(1);result='weak';}else if(this.repeat){this.doerror(2);result='weak';}else if(this.order){this.doerror(3);result='weak';}else if(!this.len&&!this.letters&&!this.numbers&&!this.specials){this.doerror(4,true);result='weak';}else if(this.len&&!this.letters&&!this.numbers&&!this.specials){this.doerror(5,true);result='mediocre';}else if(this.len&&!this.letters&&this.numbers&&!this.specials){this.doerror(6,true);result='strong';}else if(this.len&&!this.letters&&!this.numbers&&this.specials){this.doerror(7,true);result='strong';}else if(this.len&&this.letters&&!this.numbers&&!this.specials){this.doerror(8,true);result='strong';}else if(this.len&&!this.letters&&this.numbers&&this.specials){this.doerror(0,true);result='strongest';}else if(this.len&&this.letters&&!this.numbers&&this.specials){this.doerror(0,true);result='strongest';}else if(this.len&&this.letters&&this.numbers&&!this.specials){this.doerror(0,true);result='strongest';}else if(this.len&&this.letters&&this.numbers&&this.specials){this.doerror(0,true);result='strongest';}else{this.doerror(0,true);result='weak';}
this.result=result;},getResult:function(){return this.result;},draw:function(norun){bgcolor='white';boxes=0;this.showTip(true);if(norun){result='lame';}else{this.do_results();}
switch(result){case'strongest':bgcolor=this.config.bgcolor_strongest;boxes=4;break;case'strong':bgcolor=this.config.bgcolor_strong;boxes=3;break;case'mediocre':bgcolor=this.config.bgcolor_mediocre;boxes=2;break;case'weak':bgcolor=this.config.bgcolor_weak;boxes=1;break;}
for(i=1;i<5;i++){if(yu.Dom.get('meter'+i)){if(i>boxes){bgcolor='white';}
yu.Dom.setStyle('meter'+i,'backgroundColor',bgcolor);}}},test_name:function(str){if(this.config.fnameData&&this.config.fnameData.value){re='/'+this.config.fnameData.value+'/i';re=eval(re);if(str.match(re)){return true;}}
if(this.config.lnameData&&this.config.lnameData.value){re='/'+this.config.lnameData.value+'/i';re=eval(re);if(str.match(re)){return true;}}
if(this.config.uidData&&this.config.uidData.value){re='/'+this.config.uidData.value+'/i';re=eval(re);if(str.match(re)){return true;}}
return false;},test_len:function(str){if((str.length>(this.config.min_len-1))&&(str.length<(this.config.max_len+1))){return true;}
return false;},test_letters:function(str){if(str.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)){return true;}
return false;},test_numbers:function(str){var ret=false;var num=false;var let=false;if(str.match(/\d+/)){num=true;}
if(str.match(/[a-z].*/i)){let=true;}
if(num&&let){ret=true;}
return ret;},test_special:function(str){if(str.match(/[!,@,#,\$,%,^,&,\*,?,_,~]/)){return true;}
return false;},test_repeatchar:function(str){str_chars='abcdefghijklmnopqrstuvwxyz012345678909876543210zyxwvutsrqponmlkjihgfedcba';for(i=0;i<str_chars.length;i++){cmd='/['+str_chars.substr(i,1)+']+/i';cmd=eval(cmd);if(str.match(cmd)){newstr=new String(str.match(cmd));if(newstr.length>3){return true;}}}
return false;},test_order:function(str){str_chars='abcdefghijklmnopqrstuvwxyzyxwvutsrqponmlkjihgfedcba';for(i=0;i<str_chars.length;i++){nc=str_chars.substr(i+1,3);if(nc.length==3){cmd='/'+str_chars.substr(i,1)+'(?='+nc+')/i';cmd=eval(cmd);if(str.match(cmd)){return true;}}}
str_chars='012345678909876543210';for(i=0;i<str_chars.length;i++){nc=str_chars.substr(i+1,3);if(nc.length==3){cmd='/'+str_chars.substr(i,1)+'(?='+nc+')/i';cmd=eval(cmd);if(str.match(cmd)){return true;}}}
return false;}}
var ymem_reg=YAHOO.namespace("Membership.registration");Array.prototype.inArray=function(value){for(var i=0;i<this.length;i++){if(this[i]==value)return true;}
return false;};Array.prototype.isEmpty=function(){return(this.length==0);};var isArray=function(obj){return(obj.constructor.toString().match(/array/i)!==null);};var isObject=function(obj){return(typeof obj=="object");};var isInteger=function(str){return(!isNaN(str));};String.prototype.isInteger=function(){return(!isNaN(this));};String.prototype.trim=function(){var str=this.replace(/^\s+/,"");return str.replace(/\s+$/,"");};var functionExists=function(strFuncName){return(typeof eval(strFuncName)=="function");};var isDefined=function(strWhat){return(eval("typeof "+strWhat)!=="undefined");}
var isHtmlElement=function(htmlEl){return(htmlEl&&htmlEl.tagName);};var getFieldType=function(fieldEl){return(isHtmlElement(fieldEl)&&fieldEl.type)?fieldEl.type:false;};var isFormElement=function(fieldEl){return(isSelectBox(fieldEl)||isTextInputBox(fieldEl)||isHiddenField(fieldEl)||isButton(fieldEl));};var isSelectBox=function(fieldEl){return(getFieldType(fieldEl)=="select-one"||getFieldType(fieldEl)=="select-multi");};var isCheckBox=function(fieldEl){return(getFieldType(fieldEl)=="checkbox");};var isTextInputBox=function(fieldEl){var fieldType=getFieldType(fieldEl);return(fieldType=="text"||isPasswordField(fieldEl));};var isPasswordField=function(fieldEl){return(getFieldType(fieldEl)=="password");};var isHiddenField=function(fieldEl){return(getFieldType(fieldEl)=="hidden");};var isYuiAutoEl=function(fieldElId){return fieldElId&&fieldElId.indexOf("yuievtautoid",0)!==-1;};var isButton=function(fieldEl){return isHtmlElement(fieldEl)&&(fieldEl.tagName.toLowerCase()=="input"&&fieldEl.type&&fieldEl.type.toLowerCase()=="button");};var isString=function(test){return(typeof test=='string');};var Dom=YAHOO.util.Dom;var Event=YAHOO.util.Event;var Anim=YAHOO.util.Anim;ymem_reg.FormValidator=function(oConfig,oErrMessages,oInfoMessages,oCustomTests,oEventHandlers){var self=this;var OBJ_PROPERTY_NAMES={requiredFields:"_REQUIRED_FIELDS",config:"_CONFIG",errors:"_ERROR_QUEUE",errMessages:"_ERR_MESSAGES",infoMessages:"_INFO_MESSAGES",customTests:"_CUSTOM_TESTS",eventHandlers:"_EVENT_HANDLERS",controlKeys:"_CONTROL_KEYS"};var MSG_PROPS={actions:{hide:"hide",show:"show"},types:{info:"info",error:"error"},idSuffix:"-msg"};var FORM_IS_VALID=false;var VALIDATOR_DISABLED=false;this[OBJ_PROPERTY_NAMES.config]=oConfig;this[OBJ_PROPERTY_NAMES.errMessages]=oErrMessages;this[OBJ_PROPERTY_NAMES.infoMessages]=oInfoMessages;this[OBJ_PROPERTY_NAMES.customTests]=oCustomTests;this[OBJ_PROPERTY_NAMES.eventHandlers]=oEventHandlers;this[OBJ_PROPERTY_NAMES.requiredFields]={};this[OBJ_PROPERTY_NAMES.errors]={};this[OBJ_PROPERTY_NAMES.controlKeys]=[16,20,9,13,33,34,37,39,46,17];var getFormComponents=function(componentClass,rootEl){return Dom.getElementsByClassName(componentClass,null,rootEl);};var isComponentRequired=function(component,reqClass){return(Dom.getElementsByClassName(reqClass,null,component).isEmpty())?false:true;};var Message=function(msgTextAry,msgHtmlIdPrepend,msgClass,msgTemplateEl){this.msgTextAry=msgTextAry;this.msgHtmlIdPrepend=msgHtmlIdPrepend;this.msgClass=msgClass;this.msgTemplateEl=msgTemplateEl||false;this.compileMessage=function(){var msgEl,innerEls,msgTextLines,msgDiv,textNode;if(!this.msgTemplateEl)return false;msgEl=this.msgTemplateEl.cloneNode(true);Dom.removeClass(msgEl,"hidden");msgEl.id=this.msgHtmlIdPrepend+MSG_PROPS.idSuffix;for(var i=0;i<msgTextAry.length;i++){msgDiv=document.createElement("div");if(i==0)Dom.addClass(msgDiv,"first");textNode=document.createTextNode(msgTextAry[i]);msgDiv.appendChild(textNode);msgEl.appendChild(msgDiv);}
Dom.addClass(msgEl,this.msgClass);return msgEl;};return this.compileMessage();};var displayMessage=function(msgTemplateEl,msgBaseClass,msgClass,msgText,componentElId,componentClass){var msgEl,firstChildEl,componentEl;if(!msgText)return false;msgEl=new Message(msgText,componentElId,msgClass,msgTemplateEl);if(!msgEl){return false;}
componentEl=Dom.get(componentElId);Dom.addClass(componentElId,componentClass);var curMessages=Dom.getElementsByClassName(msgBaseClass,null,componentEl);if(curMessages.length>0){for(var i=0;i<curMessages.length;i++){componentEl.removeChild(curMessages[i]);}}
firstChildEl=componentEl.firstChild;componentEl.insertBefore(msgEl,firstChildEl);};var clearInfoMessages=function(oConfig){var msgs=Dom.getElementsByClassName(oConfig.msgElClasses.infoClass,"div",oConfig.formId);var parent;for(var i=0;i<msgs.length;i++){parent=msgs[i].parentNode||false;if(parent)parent.removeChild(msgs[i]);}};var clearMessage=function(componentElId,msgClass){var aNodes,componentEl=Dom.get(componentElId);var msgElToRemove=Dom.get(componentElId+MSG_PROPS.idSuffix);if(msgElToRemove==null){aNodes=Dom.getElementsByClassName(msgClass,"div",Dom.get(componentElId));msgElToRemove=(aNodes[0]!==null)?aNodes[0]:false;}
if(msgElToRemove&&msgElToRemove.parentNode&&Dom.hasClass(msgElToRemove,msgClass)){msgElToRemove.parentNode.removeChild(msgElToRemove);}};var getMessage=function(componentElId,msgClass){var componentEl=Dom.get(componentElId);var msgEl=Dom.get(componentElId+MSG_PROPS.idSuffix);if(Dom.hasClass(msgEl,msgClass)){return msgEl;}
return false;};var addRequiredFieldId=function(fieldEl,oParams){var oReqInputs=self.getProperty(OBJ_PROPERTY_NAMES.requiredFields);var componentId=oParams.componentId;var reqFieldInput=oReqInputs[componentId]||false;var fldId=fieldEl.id||false;if(fldId&&!isHiddenField(fieldEl)){if(reqFieldInput&&!reqFieldInput.inArray(fldId)){reqFieldInput.push(fldId);}else if(!reqFieldInput){oReqInputs[componentId]=Array(fldId);}}
self.setProperty(OBJ_PROPERTY_NAMES.requiredFields,oReqInputs);};var doInfoMessage=function(e,oParams){var msgText,region,anim;var componentElId=oParams.componentId;var oConfig=self.getProperty(OBJ_PROPERTY_NAMES.config);var hasErrorMsg=self.componentHasErrMsg(componentElId);var lastComponent=self.getDataCacheVal("lastComponentFocus");if(lastComponent!==componentElId){clearInfoMessages(oConfig);}
if(!hasErrorMsg){msgText=self.getMessageText(componentElId,self.getProperty(OBJ_PROPERTY_NAMES.infoMessages),false);if(msgText){msgEl=new Message(msgText,componentElId,oConfig.msgElClasses.infoClass,oConfig.msgTemplateEl);Dom.removeClass(msgEl,oConfig.msgElClasses.hiddenClass);region=Dom.getRegion(componentElId);Dom.setStyle(msgEl,"opacity","0");Dom.get(oConfig.formId).appendChild(msgEl);Dom.setXY(msgEl,[region.right-msgEl.offsetWidth,region.top],true);anim=new ymem_reg.ElementFader(msgEl);anim.fadeIn();self.setDataCacheVal("lastComponentFocus",componentElId);}}};var addInfoMsgEvents=function(fieldEl,oParams){var fieldElId=fieldEl.id;if(!isHiddenField(fieldEl)&&!isYuiAutoEl(fieldEl.id)&&!isButton(fieldEl)){Event.on(fieldEl,"focus",doInfoMessage,oParams,false);}};var addFieldEventHandlers=function(fieldEl,oParams){var componentElId=oParams.componentId;var eventHandlers=self.getProperty(OBJ_PROPERTY_NAMES.eventHandlers);var eventFieldId,eventName,fieldEvents;var addEventHandlers=function(fieldEl,fieldEvents,self){for(var eventName in fieldEvents){Event.on(fieldEl,eventName,fieldEvents[eventName],self,true);}};if(!isHiddenField(fieldEl)&&!isYuiAutoEl(fieldEl.id)&&!isButton(fieldEl)){for(eventFieldId in eventHandlers){if(eventFieldId==fieldEl.id){addEventHandlers(fieldEl,eventHandlers[eventFieldId],self);}}
addEventHandlers(fieldEl,eventHandlers["all"],self);}};var addInlineValidatorEvents=function(fieldEl,oParams){var componentElId=oParams.componentId;var oConfig=self.getProperty(OBJ_PROPERTY_NAMES.config);if(!isHiddenField(fieldEl)&&!isYuiAutoEl(fieldEl.id)&&!isButton(fieldEl)){if(!oConfig.changeValidationExemptions.inArray(fieldEl.id)){Event.on(fieldEl,"change",self.validateField,oParams,false);}
if(!oConfig.keyupValidationExemptions.inArray(fieldEl.id)){Event.on(fieldEl,"keyup",self.keyup_ValidateField,oParams,false);}}};var addLabelClass=function(componentEl,className){var labelEl;if(componentEl&&className){labelEl=Dom.getElementsByClassName("ymemformlabel","div",componentEl)[0].getElementsByTagName("label")[0]||null;Dom.addClass(labelEl,className);}};var processComponents=function(self){var curComp,curCompId,isCompReq,fieldTagNameIdx,fieldTagName,inputEls,components,fldLabel;var oConfig=self.getProperty(OBJ_PROPERTY_NAMES.config);var components=getFormComponents(oConfig.componentClass,Dom.get(oConfig.formId));for(var i=0;i<components.length;i++){curComp=components[i];curCompId=curComp.id;self.addValidatorIcon(curComp.id);isCompReq=isComponentRequired(curComp,oConfig.reqClass);for(var fieldTagNameIdx in oConfig.fieldTagNames){if(!isString(oConfig.fieldTagNames[fieldTagNameIdx]))continue;fieldTagName=oConfig.fieldTagNames[fieldTagNameIdx].toLowerCase();inputEls=curComp.getElementsByTagName(fieldTagName);if(inputEls.length>0){if(isCompReq){Dom.batch(inputEls,addRequiredFieldId,{componentId:curCompId},false);addLabelClass(curComp,"req");}else{addLabelClass(curComp,"notreq");}
Dom.batch(inputEls,addInfoMsgEvents,{componentId:curCompId},false);Dom.batch(inputEls,addFieldEventHandlers,{componentId:curCompId},false);Dom.batch(inputEls,addInlineValidatorEvents,{componentId:curCompId},false);}}}};this.dataCache={};this.disable=function(){VALIDATOR_DISABLED=true;};this.enable=function(){VALIDATOR_DISABLED=false;};this.getDataCacheVal=function(key){if(this.dataCache[key])return this.dataCache[key];return false;};this.setDataCacheVal=function(key,val){this.dataCache[key]=val;};this.getObjectPropNames=function(){return OBJ_PROPERTY_NAMES;};this.setProperty=function(propName,oProp){if(isObject(oProp)&&propName){this[propName]=oProp;return true;}
return false;};this.getProperty=function(propName){return(this[propName])?this[propName]:false;};this.getMessageText=function(componentId,messages,messageId){var getKeyedMessage=(messageId)?true:false;componentId=componentId.toLowerCase();if(getKeyedMessage){messageId=messageId.toLowerCase();return(messages[componentId]&&messages[componentId][messageId])?messages[componentId][messageId]:false;}else{return(messages[componentId])?messages[componentId]:false;}};this.hasMessage=function(componentElId,msgClass){var aNodes,msgEl=Dom.get(componentElId+MSG_PROPS.idSuffix);if(msgEl==null){aNodes=Dom.getElementsByClassName(msgClass,"div",Dom.get(componentElId));msgEl=(aNodes[0]!==null)?aNodes[0]:false;}
return(msgEl&&Dom.hasClass(msgEl,msgClass))||false;};this.componentHasErrMsg=function(componentElId){var oConfig=this.getProperty(OBJ_PROPERTY_NAMES.config);return this.hasMessage(componentElId,oConfig.msgElClasses.errClass,oConfig.errClass);};this.addError=function(fieldElId,componentElId,messageKey){var errorQueue=this.getProperty(OBJ_PROPERTY_NAMES.errors);errorQueue.push({fieldId:fieldElId,componentId:componentElId,message:this.getMessageText(componentElId,this.getProperty(OBJ_PROPERTY_NAMES.errMessages),messageKey)});this.setProperty(OBJ_PROPERTY_NAMES.errors,errorQueue);this.resetValidatorIcon(componentElId);};this.resetErrorQueue=function(){this.setProperty(OBJ_PROPERTY_NAMES.errors,[]);};this.removeErrorFromDisplay=function(componentElId){var oConfig=this.getProperty(OBJ_PROPERTY_NAMES.config);clearMessage(componentElId,oConfig.msgElClasses.errClass);Dom.removeClass(componentElId,oConfig.errClass);setTimeout("yregFormValidator.updateValidatorIcon('"+componentElId+"');",1000);};this.isFieldRequired=function(componentId,fieldElId){var oReqInputs=self.getProperty(OBJ_PROPERTY_NAMES.requiredFields);return oReqInputs[componentId]&&oReqInputs[componentId].inArray(fieldElId);};this.addValidatorIcon=function(componentElId){var iconEl,oConfig=self.getProperty(OBJ_PROPERTY_NAMES.config);var iconUri=oConfig.blankIconUri;componentEl=Dom.get(componentElId);if(typeof componentEl.appendChild!=="undefined"&&iconUri!==""){iconEl=document.createElement("img");iconEl.id=componentEl.id+"Icon";iconEl.src=iconUri;Dom.addClass(iconEl,"hidden statusIcon");componentEl.appendChild(iconEl);}};this.displayValidatorIcon=function(componentElId){this.resetValidatorIcon(componentElId);var iconEl=Dom.get(componentElId+"Icon");var oConfig=self.getProperty(OBJ_PROPERTY_NAMES.config);var iconUri=oConfig.spinnerIconUri;if(iconEl!==null){Dom.setStyle(iconEl,"opacity","1");Dom.replaceClass(iconEl,"hidden","visible");iconEl.src=iconUri;}};this.resetValidatorIcon=function(componentElId){var iconEl=Dom.get(componentElId+"Icon");var oConfig=self.getProperty(OBJ_PROPERTY_NAMES.config);var iconUri=oConfig.blankIconUri;if(iconEl!==null){iconEl.src=iconUri;Dom.setStyle(iconEl,"opacity","1");Dom.replaceClass(iconEl,"visible","hidden");}};this.updateValidatorIcon=function(componentElId){var iconEl=Dom.get(componentElId+"Icon");var oConfig=self.getProperty(OBJ_PROPERTY_NAMES.config);var iconUri=oConfig.checkIconUri;var anim;if(iconEl!==null&&!self.componentHasErrMsg(componentElId)){iconEl.src=iconUri;anim=new YAHOO.util.Anim(iconEl,{opacity:{to:0},duration:0.5});setTimeout(function(){anim.animate();},3000);}else{self.resetValidatorIcon(componentElId);}};this.keyup_ValidateField=function(e,oParams){var componentElId=oParams.componentId;var oConfig=self.getProperty(OBJ_PROPERTY_NAMES.config);var controlKeyCodes=self.getProperty(OBJ_PROPERTY_NAMES.controlKeys);if(e.keyCode&&!controlKeyCodes.inArray(e.keyCode)&&self.componentHasErrMsg(componentElId)){self.validateField(e,oParams);}};this.validateField=function(e,oParams){var oConfig=self.getProperty(OBJ_PROPERTY_NAMES.config);var fieldEl=Event.getTarget(e);var componentId=oParams.componentId;var testArg=eval("({"+componentId+": [\""+fieldEl.id+"\"]})");var customTests=self.getProperty(OBJ_PROPERTY_NAMES.customTests);var customTest,testField,testFieldKey,testGroup,testGroupKey,testInputsAry;var testsFailed;if(e.type&&e.type=="change"){self.displayValidatorIcon(componentId);}
self.resetErrorQueue();if(self.isFieldRequired(componentId,fieldEl.id)){self.runBasicFieldTests(testArg);}
for(var testFieldKey in customTests){testField=customTests[testFieldKey];for(testGroupKey in testField){testGroup=testField[testGroupKey];if(testGroup.inputFieldIds.inArray(fieldEl.id)){customTest=eval("({"+testFieldKey+" : {}})");customTest[testFieldKey]=testField;self.runCustomFieldTests(customTest,e);}}}
self.processErrorQueue();};this.validateForm=function(e,obj){var config=self.getProperty(OBJ_PROPERTY_NAMES.config);var doErrorChecking=function(self){var customTests=self.getProperty(OBJ_PROPERTY_NAMES.customTests);var oReqInputs=self.getProperty(OBJ_PROPERTY_NAMES.requiredFields);self.runBasicFieldTests(oReqInputs);self.runCustomFieldTests(customTests,e);};if(!VALIDATOR_DISABLED){this.resetErrorQueue();doErrorChecking(this);this.processErrorQueue();if(!FORM_IS_VALID){Event.preventDefault(e);}else{if(typeof e.type!=="undefined"&&e.type!=="submit"){Dom.get(config.formId).submit();}}}};this.runBasicFieldTests=function(oFields){var componentElId,fieldElIdAry,fieldEl,fieldElId,fieldValidator,oValidatorReturn,i;for(componentElId in oFields){fieldElIdAry=oFields[componentElId];if(isObject(fieldElIdAry)){for(var i=0;i<fieldElIdAry.length;i++){fieldElId=fieldElIdAry[i];fieldEl=Dom.get(fieldElId);fieldValidator=new ymem_reg.FieldValidator(fieldEl);oValidatorReturn=fieldValidator.test()||false;if(oValidatorReturn&&oValidatorReturn.msg!==""){this.addError(fieldElId,componentElId,oValidatorReturn.msg);}else{this.removeErrorFromDisplay(componentElId);}}}}};this.runCustomFieldTests=function(customTests,e){var key,testKey,testCase,testResult,testCallback,i;for(key in customTests){for(idx in customTests[key]){testCase=customTests[key][idx];with(testCase){if(!isObject(validators))break;for(testKey in validators){testCallback=validators[testKey];testResult=testCallback(inputFieldIds,e);if(testResult==true){for(i=0;i<componentIds.length;i++){this.addError(inputFieldIds[i],componentIds[i],testKey.toLowerCase());}}else if(testResult==false){for(i=0;i<componentIds.length;i++){this.removeErrorFromDisplay(componentIds[i]);}}}}
if(testResult)break;}}};this.processErrorQueue=function(){var oConfig=this.getProperty(OBJ_PROPERTY_NAMES.config);var errorQueue=this.getProperty(OBJ_PROPERTY_NAMES.errors);if(errorQueue.length==0){FORM_IS_VALID=true;}else{clearInfoMessages(oConfig);for(i=0;i<errorQueue.length;i++){displayMessage(oConfig.msgTemplateEl,oConfig.msgElClasses.baseClass,oConfig.msgElClasses.errClass,errorQueue[i].message,errorQueue[i].componentId,oConfig.errClass);}
FORM_IS_VALID=false;}};this.init=function(){processComponents(self);this.resetErrorQueue();Event.on(self.getProperty(OBJ_PROPERTY_NAMES.config).formId,"submit",self.validateForm,self,true);};}
ymem_reg.FieldValidator=function(fieldEl){var retObj={msg:"",fieldType:""}
this.fieldEl=fieldEl;this.isEmptyField=function(){return(typeof this.fieldEl.value!=="undefined"&&this.fieldEl.value.trim()=="");};this.isOptionSelected=function(){var fieldEl=this.fieldEl;return(fieldEl.options&&fieldEl.options[fieldEl.selectedIndex].value!=="");};this.isChecked=function(){return this.fieldEl.checked;};this.test=function(){retObj.fieldType=getFieldType(this.fieldEl);if(isTextInputBox(this.fieldEl)&&this.isEmptyField()){retObj.msg="empty";}else if(isSelectBox(this.fieldEl)&&!this.isOptionSelected()){retObj.msg="notselected";}else if(isCheckBox(this.fieldEl)&&!this.isChecked()){retObj.msg="notchecked";}
return retObj;};};ymem_reg.DateValidator=function(yy,mm,dd){if(!isInteger(yy)){this.yy=0;}else if(yy.length==2&&yy.charAt(0)=="0"){this.yy=parseInt(yy,10)+2000;}else if(yy<=99){this.yy=parseInt(yy,10)+1900;}else{this.yy=yy;}
this.mm=isInteger(mm)?mm:0;this.dd=isInteger(dd)?dd:0;this.monthDayMap={0:31,1:28,2:31,3:30,4:31,5:30,6:31,7:31,8:30,9:31,10:30,11:31};};ymem_reg.DateValidator.prototype=(function(){return({isFutureDate:function(){return(new Date()<new Date(this.yy,this.mm,this.dd));},isPastDate:function(){return(new Date()>new Date(this.yy,this.mm,this.dd));},isFutureYear:function(){return(new Date().getFullYear()<this.yy);},subtractYearFromNow:function(objDate,howFar){return objDate.getFullYear()-howFar;},isPastYear:function(howFar){var now=new Date();return(new Date(this.yy,this.mm,this.dd)<new Date(this.subtractYearFromNow(now,howFar),now.getMonth(),now.getDate()));},isLeapishYear:function(){return(this.yy%4==0)||(this.yy%100==0)||(this.yy%400==0);},getDayCountForMonth:function(){return(this.monthDayMap[this.mm])?this.monthDayMap[this.mm]:0;},setDayCountForMonth:function(mm,dd){return(this.monthDayMap[mm]=dd);},isValidDate:function(){if(this.isLeapishYear()){this.setDayCountForMonth(1,29);}
return((this.yy>0&&this.mm>=0&&this.dd>0)&&this.getDayCountForMonth()>=this.dd);}});})();ymem_reg.ElementFader=function(el){this.el=el;this.isAnimating=false;this.duration=0.3;this.fadeIn=function(){this.opacity={from:0,to:1};this.animate();};this.fadeOut=function(){this.opacity={from:1,to:0};this.animate();};this.animate=function(){var anim=new Anim(this.el,{opacity:this.opacity});anim.duration=this.duration;anim.onStart.subscribe(function(e){this.isAnimating=true;});anim.onComplete.subscribe(function(e){this.isAnimating=false;});if(!this.isAnimating){anim.animate();}};return this;};var fieldEvents={all:{focus:function(e){},blur:function(e){},keypress:function(e){if(e&&e.keyCode&&e.keyCode==13){Event.stopEvent(e);}
if(e&&Event.getCharCode(e)==92){Event.stopEvent(e);}}},firstname:{blur:function(e){var fieldEl=Event.getTarget(e);if(isDefined("ymem_common.toTitleCase")){fieldEl.value=ymem_common.toTitleCase(fieldEl.value);}}},secondname:{blur:function(e){var fieldEl=Event.getTarget(e);if(isDefined("ymem_common.toTitleCase")){fieldEl.value=ymem_common.toTitleCase(fieldEl.value);}}},password:{keyup:function(e){var field=Event.getTarget(e);var pwcField=Dom.get("passwordconfirm");var controlKeys=yregFormValidator._CONTROL_KEYS;if(e.keyCode&&!controlKeys.inArray(e.keyCode)){if(pwcField!==null){pwcField.value="";}
if(field.value.length>=6){yregFormValidator.validateField(e,{componentId:"passwordFld"});}}}},passwordconfirm:{keyup:function(e){var field=Event.getTarget(e);var pwField=Dom.get("password");var controlKeys=yregFormValidator._CONTROL_KEYS;if(pwField!==null&&e.keyCode&&!controlKeys.inArray(e.keyCode)&&field.value.length>=pwField.value.length){yregFormValidator.validateField(e,{componentId:"confPasswordFld"});}}}};var customFieldTests={firstname:{0:{inputFieldIds:["firstname","secondname"],componentIds:["fullnameFld"],validators:{invalidsymbols:function(fieldIds,e){var fields=Dom.get(fieldIds);var defaultVals=yregFormValidator._CONFIG.defaultVals;var pattern=/[0123456789!@#$%\^&*()_=+[\]{}\\|;:"/<>`~\xc2\xaa\xc2\xa3\xc2\xa2\xc2\xb0\xc2\xa4\xc2\xa6\xc2\xa5\xc2\xbb\xc2\xbc\xc3\x90\xc2\xad\xc3\x9e\xc2\xb1\xc2\xb2\xc2\xb3\xc2\xb7\xc2\xa8\xc2\xb9\xc2\xab\xc2\xac\xc2\xb8\xc2\xb6\xc2\xa9\xc3\xb0\xc2\xbd\xc2\xba\xc2\xb5\xc3\xbc\xc3\xbe\xc3\x97]/i;var retFlag,field,defaultVal,val;for(var i=0;i<fields.length;i++){field=fields[i];val=field.value||false;if(field!==null&&ymem_common.removeAccentedChars(field.value).match(pattern)!==null){return true;}}
return false;},empty:function(fieldIds,e){var defaultVals=yregFormValidator._CONFIG.defaultVals;var eventTarget=Event.getTarget(e),fields;if(fieldIds.inArray(eventTarget.id)){fields=[eventTarget];}else{fields=Dom.get(fieldIds);}
var field,val,defaultVal;for(var i=0;i<fields.length;i++){field=fields[i];val=field.value||false;defaultVal=(typeof defaultVals[field.id]=="undefined")?false:defaultVals[field.id];if(field&&val&&defaultVal!==""&&val==defaultVal){return true;}}
return false;}}}},password:{0:{inputFieldIds:["password"],componentIds:["passwordFld"],validators:{nospaces:function(fieldIds,e){var fieldEl=Dom.get(fieldIds[0])||false;return(fieldEl&&fieldEl.value&&fieldEl.value.indexOf(" ")!==-1);},notlongenough:function(fieldIds,e){var fieldEl=Dom.get(fieldIds[0])||false;return(fieldEl&&fieldEl.value&&fieldEl.value.length<6);},invalidcontents:function(fieldIds,e){var fieldEl=Dom.get(fieldIds[0])||false;var testStrings=["password"],isIn=false,testStr="";var yidField=Dom.get("yahooid")||false;var fnameField=Dom.get("firstname")||false;var lnameField=Dom.get("secondname")||false;if(yidField&&yidField.value)testStrings.push(yidField.value.toLowerCase());if(fnameField&&fnameField.value)testStrings.push(fnameField.value.toLowerCase());if(lnameField&&lnameField.value)testStrings.push(lnameField.value.toLowerCase());for(var i=0;i<testStrings.length;i++){isIn=fieldEl&&fieldEl.value.toLowerCase().indexOf(testStrings[i])!==-1;if(isIn){break;}}
return isIn;}}}},passwordconfirm:{0:{inputFieldIds:["passwordconfirm"],componentIds:["confPasswordFld"],validators:{nomatch:function(fieldIds,e){var passwordFields=Dom.get(fieldIds);passwordFields.push(Dom.get("password"));if(passwordFields.length==2){return passwordFields[0].value!==passwordFields[1].value;}
return null;}}}},yahooid:{0:{inputFieldIds:["yahooid"],componentIds:["yahooIdFld"],validators:{invalidchars:function(fieldIds,e){var fieldEl=Dom.get(fieldIds[0])||false;var pattern=/[^a-z0-9._]|\..*\./i;return(fieldEl&&fieldEl.value.match(pattern)!==null);},notlongenough:function(fieldIds,e){var fieldEl=Dom.get(fieldIds[0])||false;return(fieldEl&&fieldEl.value&&fieldEl.value.length<4);},invalidfirstchar:function(fieldIds,e){var fieldEl=Dom.get(fieldIds[0])||false;var pattern=/^[^a-z]/i;return(fieldEl&&fieldEl.value&&fieldEl.value.charAt(0).match(pattern)!==null);},dotunderscore:function(fieldIds,e){var fieldEl=Dom.get(fieldIds[0])||false;var pattern=/\._|_\./;return(fieldEl&&fieldEl.value&&fieldEl.value.match(pattern)!==null);},consecutivechars:function(fieldIds,e){var fieldEl=Dom.get(fieldIds[0])||false;return(fieldEl&&fieldEl.value&&(fieldEl.value.indexOf("..")!==-1||fieldEl.value.indexOf("__")!==-1));},invalidending:function(fieldIds,e){var fieldEl=Dom.get(fieldIds[0])||false;var pattern=/[._]$/;return(fieldEl&&fieldEl.value&&fieldEl.value.match(pattern)!==null);}}}},dob:{0:{inputFieldIds:["dd","mm","yyyy"],componentIds:["dobFld"],validators:{invaliddate:function(fieldIds,e){var defaultVals=yregFormValidator._CONFIG.defaultVals;var eventTarget=Event.getTarget(e);var fieldEls=Dom.get(fieldIds);var dd=fieldEls[0].value,mm=parseInt(fieldEls[1].value)-1,yyyy=fieldEls[2].value;if(fieldIds.inArray(eventTarget.id)&&(dd==defaultVals["dd"]||yyyy==defaultVals["yyyy"])){return null;}
var dateValidator=new ymem_reg.DateValidator(yyyy,mm,dd);var result=dateValidator.isValidDate();if(result&&e.type!=="keyup"){fieldEls[2].value=dateValidator.yy;}
return!result;},futuredate:function(fieldIds,e){var defaultVals=yregFormValidator._CONFIG.defaultVals;var eventTarget=Event.getTarget(e);var fieldEls=Dom.get(fieldIds);var dd=fieldEls[0].value,mm=parseInt(fieldEls[1].value)-1,yyyy=fieldEls[2].value;if(fieldIds.inArray(eventTarget.id)&&(dd==defaultVals["dd"]||yyyy==defaultVals["yyyy"])){return null;}
var dateValidator=new ymem_reg.DateValidator(yyyy,mm,dd);return(dateValidator.isFutureDate());},pastyear:function(fieldIds,e){var defaultVals=yregFormValidator._CONFIG.defaultVals;var eventTarget=Event.getTarget(e);var fieldEls=Dom.get(fieldIds);var dd=fieldEls[0].value,mm=parseInt(fieldEls[1].value)-1,yyyy=fieldEls[2].value;if(fieldIds.inArray(eventTarget.id)&&(dd==defaultVals["dd"]||yyyy==defaultVals["yyyy"])){return null;}
var dateValidator=new ymem_reg.DateValidator(yyyy,mm,dd);return(dateValidator.isPastYear(150));}}}},altemail:{0:{inputFieldIds:["altemail"],componentIds:["altEmailFld"],validators:{invalidformat:function(fieldIds,e){var fieldEl=Dom.get(fieldIds)[0]||false;if(fieldEl!==null&&fieldEl.value=="")return false;var pattern=/^[a-z0-9_\-\.]+@[a-z0-9]+[a-z0-9_\-\.]*\.[a-z]{2,}$/i;if(fieldEl.value.match(pattern)!==null)
{var yidVal=(Dom.get("yahooid")==null)?"":Dom.get("yahooid").value.trim();var newEmail=yidVal+yregFormValidator._CONFIG.emailSuffix;if(yidVal!=="")
{return(newEmail==fieldEl.value);}
else
{return false;}}
else
{return true;}}}}},secquestionanswer:{0:{inputFieldIds:["secquestionanswer"],componentIds:["secureAnswerFld"],validators:{notlongenough:function(fieldIds,e){var fieldEl=Dom.get(fieldIds)[0]||false;return fieldEl&&fieldEl.value&&fieldEl.value.length<4;}}},1:{inputFieldIds:["secquestionanswer","password"],componentIds:["secureAnswerFld"],validators:{sameaspasswd:function(fieldIds,e){var sqaEl=Dom.get(fieldIds)[0]||false;var pwEl=Dom.get(fieldIds)[1]||false;if(sqaEl&&pwEl&&sqaEl.value&&pwEl.value){return sqaEl.value==pwEl.value;}}}}},tos:{0:{inputFieldIds:["tos"],componentIds:["regTosFld"],validators:{notchecked:function(fieldIds,e){var fieldEl=Dom.get(fieldIds)[0]||false;return(fieldEl&&!fieldEl.checked);}}}}};
